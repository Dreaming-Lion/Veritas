# Veritas

<img width="591" height="287" alt="Image" src="https://github.com/user-attachments/assets/74d4509e-aa9e-4161-9f10-3430fa3d2023" />

## 🌞 프로젝트 소개
- Veritas는 미디어 리터러시 역량 강화를 위한 정치 뉴스 플랫폼입니다.
- 현대 사회에서 개인화를 위해 주로 사용되는 추천 알고리즘은 사용자의 만족도는 증가시키지만, 자신의 견해가 옳다는 것을 확인시켜주는 증거는 적극적으로 찾고, 반박하는 증거는 찾으려 하지 않거나 무시하는 경향성인 확증 편향 문제를 심화시킵니다.
- 이로 인해 사람들의 견해가 양극화되고, 자신과 다른 의견을 가진 사람들에 대한 이해와 대화가 점점 어려워지고 있으며, 자극적인 주장과 가짜 뉴스가 더 잘 퍼지면서, 사회 전체의 신뢰와 민주적 의사결정 역시 흔들리고 있습니다.
- Veritas는 이러한 상황 속에서 사용자들이 미디어 리터러시 역량을 강화시키고 스스로 판단할 수 있는 능력을 기를 수 있도록 하는 것을 목표로 합니다.
- 일반적으로 미디어 리터러시 능력을 강화하는 방법에는 자신의 견해와 반대되는 의견을 가진 저자의 글을 읽거나, 다양한 정치 스펙트럼 뉴스 매체를 참고하여 여러 각도에서 생각해 보는 비판적 사고 능력을 기르는 것이 있습니다.
- 본 시스템은 사용자가 클릭한 기사 뿐만 아니라, 해당 기사와 상반되는 관점의 기사를 함께 제공하며, 법안 발의나 뉴스 브리핑과 같은 주요 정치 정보에 대해서는 제안 이유와 주요 내용이 담긴 원본 자료를 함께 제시하여 사용자가 왜곡되지 않은 정보를 바탕으로 증거 기반의 정치적 판단을 내릴 수 있도록 하고 있습니다.

<br>

## 🌞 프로젝트 구현

<img width="595" height="274" alt="Image" src="https://github.com/user-attachments/assets/4f932101-e528-41e6-b8cf-6e3053c11669" />


### 반대 성향 기사 추천 - ver 1
- 사용자가 클릭한 뉴스 기사의 원본 URL을 추출하여 언론사와 매칭하고, 해당 언론사의 정치 성향(진보/중도/보수)을 추론합니다. 이후 이 성향과 반대되는 정치 성향(ex. 보수 → 진보 / 진보 → 보수 / 중도 → 진보·보수)의 언론사들로만 구성된 뉴스 기사 리스트를 1차 후보 집합으로 만듭니다. 반대 성향 기사가 전혀 없는 경우에만 전체 기사 집합을 사용합니다.
- 이후, 기준이 되는 클릭 기사의 본문(제목 + 일부 본문)을 TF-IDF로 벡터화하고, 48시간 이내의 반대 성향 기사 리스트와의 코사인 유사도를 계산해 상위 50개의 유사 기사를 1차 후보로 선정합니다.
- 1차 후보 기사에 대해 NLI 모델(mDeBERTa XNLI)을 사용해 클릭 기사와 수집한 기사 간 논리적 관계를 추론하고, NLI가 반환한 확률(contradiction − entailment)을 기반으로 한 stance 스코어가 특정 임계치 이상인 기사만 최종 추천 목록에 포함하여, 내용적으로 관련이 있으면서도 관점 차이가 존재하는 기사만 남겼습니다.
- 또한 추천 시스템의 품질을 높이고, 다양한 언론사의 기사를 추천받을 수 있도록 15개 언론사의 정치 뉴스 RSS를 크롤링했고, 각 언론사의 정치적 성향(진보/중도/보수)을 스코어링에 반영했습니다. 이를 통해 단순 유사 기사 추천이 아닌, 다양한 정치 스펙트럼의 기사를 균형 있게 제공하는 구조를 구현했습니다.
- 이러한 방식을 통해 사용자가 클릭한 뉴스 기사와 정치적 성향이 다른 언론사의 기사를 함께 추천받을 수 있도록 합니다.

<br>

#### 추천 시스템 성능 최적화 및 캐싱 전략
- 반대 성향 기사 추천 프로세스는 TF-IDF 연산과 NLI 추론 등 복잡한 연산을 포함하기 때문에, 사용자가 추천 결과를 응답받기까지 시간이 오래 걸릴 수 있다는 단점이 있습니다.
- 그래서 실제 서비스 환경에서의 성능과 응답 속도를 고려하여, 계산된 추천 결과는 PostgreSQL의 `article_reco` 테이블에 JSONB 형태로 캐싱하고, 최대 6시간 동안 재사용하도록 설계했습니다.
- 동일한 기사에 대해 동일한 파라미터(시간 창, 추천 개수, stance 임계값)로 요청이 들어올 경우 캐시된 결과를 우선 활용하고, 캐시가 오래된 경우에는 오래된 결과를 먼저 반환한 뒤 백그라운드에서 추천을 재계산해 캐시를 갱신하는 방식으로 API 응답 지연을 최소화했습니다.
- 또한 별도의 배치 작업을 통해 최근 기사들에 대한 추천 결과를 미리 계산해 두어, 트래픽이 몰리는 상황에서도 안정적으로 추천 기능을 제공할 수 있도록 했습니다.

<br>

### 반대 기사 추천 - ver 2 (최신 버전)
- 기존 시스템은 캐싱 전략 없이 사용자 클릭 시 추천 연산을 시작하는 구조로 가면, Latency가 커지므로 사용자 편의성이 떨어진다는 문제점이 존재합니다.
- 따라서 이를 줄이기 위해 새 기사가 들어올 때마다 추천 결과를 미리 계산하여 저장하는 구조를 택하는데, 이로 인해 백그라운드 계산, 배치 계산 파이프라인이 필수적입니다.
- 캐싱 전략으로 구현 시 수많은 연산을 미리 계산해 두고, 그 결과를 저장하여 재사용 하는 구조를 지닙니다.
- 모델이나 파라미터 조합마다 추천 결과를 미리 저장하므로캐시 계산 비용이 크고, 모델 교체 시 모든 데이터에 대한 재연산이 필요하여 모델 교체나 튜닝 비용이 크다는 단점이 존재하고, 대규모 데이터에 가까울수록 비효율적인 구조를 지니게 됩니다.
- 따라서 이를 해결하기 위해 본 시스템에서는 벡터 기반 검색을 기본 연산으로 활용합니다.
- 이는 새 기사/새 조합에도 매번 동일한 파이프라인을 거쳐 항상 비슷한 Latency를 유지할 수 있습니다.
- 또한, 새 기사는 임베딩 모델을 거쳐 임베딩 벡터를 생성한 뒤, 벡터DB에 저장하면 곧바로 검색 대상이 되므로 별도의 캐시 만료/재계산 없이도 항상 최신 기사를 포함한 기사 추천이 가능해집니다.
- 따라서 추천 결과를 미리 계산할 필요가 없어 대규모 데이터 환경에서도 효율적이며, 모델이나 파라미터 조합이 변경되어도 벡터 검색 및 Re-Ranking 과정만 변경하면 되므로 모델 교체나 튜닝 비용이 상대적으로 줄어듭니다.

<img width="829" height="535" alt="Image" src="https://github.com/user-attachments/assets/cf69026f-5012-4d98-9554-6ea5729202cd" />

<br>

### 관련 발의 법안 정보 및 관련 브리핑 정보 추천
- 정치 뉴스 기사에서 제목과 본문 일부를 추출해 하나의 쿼리 텍스트를 생성합니다.
- 발의 법안 원문과 정부 브리핑 문서를 TF-IDF로 벡터화하고, 기사 쿼리와의 코사인 유사도를 계산하여 가장 관련성이 높은 문서를 선택합니다.
- (이 과정에서 문화체육관광부에서 제공하는 공공 데이터인 정책 브리핑 연설문/보도 자료/정책 뉴스 API와 국회 사무처에서 제공하는 국회의원 법률 발의안 공공 데이터를 활용하였습니다.)
- 이후, 유사도 점수가 설정한 임계값(min_sim) 미만인 경우에는 관련성이 낮다고 판단해 추천하지 않도록 합니다.
- 최종적으로 선택된 문서는 `BriefingInfo` 형태로 가공되며, 주관 부처/기관명, 승인 일시, 제목, 본문 요약, 원문 링크 정보를 기사 상세 화면에서 함께 제공합니다.
- 이를 통해 사용자는 언론 기사가 다루는 이슈에 대해 실제 발의 법안 및 정부 브리핑 원문을 동시에 참고할 수 있어, 보다 근거 기반의 정치적 판단을 내릴 수 있습니다.

<br>

## 데이터 및 저작권 안내
- 본 프로젝트는 반대 성향 기사 추천을 위해 RSS 피드를 활용하여 뉴스 기사 메타데이터를 수집하며, 뉴스 기사 본문 및 관련 이미지의 저작권은 각 언론사 및 제공자에게 있습니다.
- 본 프로젝트는 상업적 용도가 아니며, 캡스톤 디자인 및 학술 연구 목적으로만 사용됩니다.
- 서비스 운영 시 각 데이터 제공자의 이용 약관 및 저작권 정책을 준수해야 합니다.

<br>

## 🐳 Docker 로 실행하기

```bash
# Docker 컨테이너 실행
./start-dev.sh

# log 확인
./logs.sh

# Docker 컨테이너 종료
./stop.sh

# Docker 자원 정리
./clean-docker.sh
```

<br>

## 📝 커밋 메시지 컨벤션

```
feat        : 새로운 기능 추가
fix         : 버그 수정
docs        : 문서 수정
style       : 코드 포맷팅, 세미콜론 누락 등
refactor    : 코드 리팩토링
test        : 테스트 코드 추가/수정
chore       : 빌드 업무 수정, 패키지 매니저 수정 등
```

#### 예시
```
feat(frontend): 로그인 페이지 UI 구현
fix(backend): 사용자 인증 API 버그 수정
docs: README 업데이트
style(frontend): 코드 포맷팅 적용
```

<br>

## 실행 시 유의 사항
- DB 테이블 오류 발생 시 Git bash에 붙여넣기
```
docker compose exec -e PGPASSWORD=apppw -T db \
  psql -v ON_ERROR_STOP=1 -U appuser -d appdb <<'SQL'
BEGIN;

CREATE TABLE IF NOT EXISTS public.news (
  id bigserial PRIMARY KEY
);

ALTER TABLE public.news
  ADD COLUMN IF NOT EXISTS source  text,
  ADD COLUMN IF NOT EXISTS lean    text,
  ADD COLUMN IF NOT EXISTS title   text,
  ADD COLUMN IF NOT EXISTS summary text,
  ADD COLUMN IF NOT EXISTS content text,
  ADD COLUMN IF NOT EXISTS link    text,
  ADD COLUMN IF NOT EXISTS "date"  timestamptz,
  ADD COLUMN IF NOT EXISTS author  text,
  ADD COLUMN IF NOT EXISTS section text,
  ADD COLUMN IF NOT EXISTS origin  text DEFAULT 'rss';

CREATE UNIQUE INDEX IF NOT EXISTS news_link_unique ON public.news (link);

CREATE INDEX IF NOT EXISTS idx_news_origin_date ON public.news (origin, "date" DESC);
CREATE INDEX IF NOT EXISTS idx_news_source      ON public.news (source);

COMMIT;
SQL

```